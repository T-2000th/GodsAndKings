egypt_missions_first = {
	slot = 1
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		tag = EGY
	}

	egypt_conquest_west_1 = {
		icon = mission_egyptian_mamluk_soldier
		position = 1
		required_missions = { }

		provinces_to_highlight = {
			province_id = 358
		}

		trigger = {
			358 = {
				infantry_in_province = 10
				cavalry_in_province = 5
			}
		}

		effect = {
			cyrenaica_area = {
				add_claim = ROOT
			}
			add_faction_influence = {
				faction = wr_berbers
				influence = 5
			}
		}
	}

	egypt_conquest_west_2 = {
		icon = mission_egyptian_mamluk_soldier
		position = 2
		required_missions = { egypt_conquest_west_1 }

		provinces_to_highlight = {
			area = cyrenaica_area
			NOT = { owned_by = ROOT }
		}

		trigger = {
			cyrenaica_area = {
				type = all
				owned_by = ROOT
			}
			treasury = 200
		}

		effect = {
			add_treasury = -200
			358 = { # Alexandria
				add_province_modifier = {
					name = egy_desert_campaigns
					duration = 10950 # 30 years
				}
			}

			add_permanent_claim_multi_provinces = { target = tripolitania_area }
			add_permanent_claim_multi_provinces = { target = fezzan_area }
			add_permanent_claim_multi_provinces = { target = djerba_area }

			add_faction_influence = {
				faction = wr_berbers
				influence = 10
			}
		}
	}

	egypt_conquest_west_3 = { # Raise new Berber regiments
		icon = mission_egyptian_mamluk_soldier
		position = 3
		required_missions = { egypt_conquest_west_2 }

		trigger = {
			calc_true_if = {
				amount = 10
				all_owned_province = {
					region = maghreb_region

					OR = {
						has_building = dock
						has_building = shipyard
						has_building = regimental_camp
					}
				}
			}
			num_of_cavalry = 10
			num_of_galley = 25
		}

		effect = {
			add_faction_influence = {
				faction = wr_berbers
				influence = 15
			}
			add_treasury = 500

			tunisia_area = { add_claim = ROOT }
			fezzan_area = { add_claim = ROOT }
			north_saharan_area = { add_claim = ROOT }
			2474 = { add_claim = ROOT } # Bottom of Fezzan
		}
	}

	egypt_conquest_west_4 = { # Secure the hinterlands
		icon = mission_egyptian_mamluk_soldier
		position = 3
		required_missions = { egypt_conquest_west_3 }

		trigger = {
			tunisia_area = {
				type = all
				owned_by = ROOT
			}
			fezzan_area = {
				type = all
				owned_by = ROOT
			}
			north_saharan_area = {
				type = all
				owned_by = ROOT
			}
			2474 = { owned_by = ROOT }
		}

		effect = {
			add_faction_influence = {
				faction = wr_berbers
				influence = 10
			}
			if = {
				limit = {
					358 = {
						has_province_modifier = egy_desert_campaigns
					}
				}
				358 = {
					extend_province_modifier = {
						name = egy_desert_campaigns
						duration = 10950
					}
				}
			}

			kabylia_area = { add_permanent_claim = ROOT }
			ouled_nail_area = { add_permanent_claim = ROOT }
			hautes_plaines_area = { add_permanent_claim = ROOT }
			barbary_coast_area = { add_permanent_claim = ROOT }
			algiers_area = { add_permanent_claim = ROOT }
		}
	}

	egypt_conquest_west_5 = { # Returning home (conquer Algeria)
		icon = mission_egyptian_mamluk_soldier
		position = 5
		required_missions = { egypt_conquest_west_4 }

		trigger = {
			kabylia_area = {
				type = all
				owned_by = ROOT
			}
			ouled_nail_area = {
				type = all
				owned_by = ROOT
			}
			hautes_plaines_area = {
				type = all
				owned_by = ROOT
			}
			barbary_coast_area = {
				type = all
				owned_by = ROOT
			}
			algiers_area = {
				type = all
				owned_by = ROOT
			}
		}

		effect = {
			add_country_modifier = {
				name = egy_berber_homeland_secured
				duration = -1
			}
			add_prestige_or_monarch_power = { amount = 50 }

			custom_tooltip = egy_subjugate_morrocco_TT
			# hidden_effect = {
				every_known_country = {
					limit = {
						capital_scope = {
							region = maghreb_region
						}
						NOT = { is_subject_of = ROOT }
					}
					ROOT = {
						add_casus_belli = {
							type = cb_vassalize_mission
							target = PREV
							months = 300
						}
					}
				}
			# }
		}
	}
}

egypt_missions_second = {
	slot = 2
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		tag = EGY
	}

	egypt_development_1 = { # Dev upper nile, then secure rest of egypt region
		icon = mission_egyptian_mamluk_soldier
		position = 1
		required_missions = { }

		provinces_to_highlight = {
			owned_by = ROOT
			OR = {
				area = vostani_area
				area = said_area
			}
			NOT = { development = 9 }
		}

		trigger = {
			NOT = {
				any_owned_province = {
					OR = {
						area = vostani_area
						area = said_area
					}
					NOT = { development = 9 }
				}
			}
		}

		effect = {
			add_permanent_claim_multi_provinces = { target = said_area }
			add_permanent_claim_multi_provinces = { target = gulf_of_arabia_area }
			add_faction_influence = {
				faction = wr_nubians
				influence = 10
			}
		}
	}

	egypt_development_2 = {
		icon = mission_egyptian_mamluk_soldier
		position = 2
		required_missions = { egypt_development_1 }

		provinces_to_highlight = {
			OR = {
				area = said_area
				area = gulf_of_arabia_area
			}
			NOT = { owned_by = ROOT }
		}

		trigger = {
			said_area = {
				type = all
				owned_by = root
			}
			gulf_of_arabia_area = {
				type = all
				owned_by = root
			}
		}
		effect = {
			add_permanent_claim_multi_provinces = { target = egypt_region }
			add_permanent_claim = 2324
			add_faction_influence = {
				faction = wr_nubians
				influence = 10
			}
		}
	}

	egypt_development_3 = {
		icon = mission_egyptian_mamluk_soldier
		position = 3
		required_missions = { egypt_development_2 }

		provinces_to_highlight = {
			OR = {
				area = lower_nubia_area
				province_id = 2324
			}
			NOT = { owned_by = ROOT }
		}

		trigger = {
			lower_nubia_area = {
				type = all
				owned_by = ROOT
			}
			owns = 2324
			num_of_owned_provinces_with = {
				value = 10
				OR = {
					region = egypt_region
				}
				num_of_buildings_in_province = 1
			}
		}

		effect = {
			add_stability_or_adm_power = yes
			add_country_modifier = {
				name = egy_economic_boom
				duration = 3650
			}
			add_faction_influence = {
				faction = wr_nubians
				influence = 15
			}
		}
	}
}

egypt_missions_third = {
	slot = 3
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		tag = EGY
	}
}

egypt_missions_fourth = {
	slot = 4
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		tag = EGY
	}

	egypt_restore_jerusalem_1 = {
		icon = mission_egyptian_mamluk_soldier
		position = 3
		required_missions = { egypt_conquest_east_2 }

		provinces_to_highlight = {
			province_id = 379
		}

		trigger = {
			379 = {
				NOT = { devastation = 1 }
				has_building = temple
			}
		}

		effect = {
			if = { # If holy city of jerusalem < tier 2
				limit = {
					379 = {
						NOT = {
							has_great_project = { type = holy_city_jerusalem tier = 2 }
						}
					}
				}

				add_treasury = -500
				379 = {
					add_great_project_tier = { type = holy_city_jerusalem tier = 1 }
				}
			}
			else = {
				add_treasury = 500
				add_adm_power = 100
			}
		}
	}

	egypt_conquest_east_4 = {
		icon = mission_egyptian_mamluk_soldier
		position = 5
		required_missions = { egypt_conquest_east_3 }

		provinces_to_highlight = {
			is_capital_of = HED
		}

		trigger = {
			OR = {
				has_spy_network_in = {
					who = HED
					value = 50
				}
				NOT = { exists = HED }
			}
		}

		effect = {
			add_permanent_claim_multi_provinces = { target = tabuk_area }
			add_permanent_claim_multi_provinces = { target = medina_area }
			add_permanent_claim_multi_provinces = { target = mecca_area }

			if = {
				limit = {
					mission_completed = egypt_restore_jerusalem_1
				}
				add_country_modifier = {
					name = egy_justified_war_mod
					duration = 3650
				}
			}

			add_faction_influence = {
				faction = wr_mamluks
				influence = 5
			}
		}
	}
}

egypt_missions_fifth = {
	slot = 5
	generic = no
	ai = yes
	has_country_shield = yes
	potential = {
		tag = EGY
	}

	egypt_conquest_east_1 = {
		icon = mission_egyptian_mamluk_soldier
		position = 1
		required_missions = { }

		provinces_to_highlight = {
			area = palestine_area
			NOT = { owned_by = ROOT }
			NOT = { is_claim = ROOT }
		}

		trigger = {
			any_province = {
				area = palestine_area
				is_claim = ROOT
				NOT = { owned_by = ROOT }
			}
		}

		effect = {
			palestine_area = {
				add_claim = ROOT
			}
			add_country_modifier = {
				name = egy_justified_war_mod
				duration = 3650
			}
			add_faction_influence = {
				faction = wr_mamluks
				influence = 5
			}
		}
	}

	egypt_conquest_east_2 = {
		icon = mission_egyptian_mamluk_soldier
		position = 2
		required_missions = { egypt_conquest_east_1 }

		provinces_to_highlight = {
			area = palestine_area
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}

		trigger = {
			palestine_area = {
				type = all
				country_or_non_sovereign_subject_holds = ROOT
			}
		}

		effect = {
			add_treasury = 100
			MAM = {
				every_owned_province = {
					add_claim = ROOT
				}
			}

			add_faction_influence = {
				faction = wr_mamluks
				influence = 10
			}
		}
	}

	egypt_conquest_east_3 = {
		icon = mission_egyptian_mamluk_soldier
		position = 4
		required_missions = { egypt_conquest_east_2 }

		provinces_to_highlight = {
			owned_by = MAM
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}

		trigger = {
			OR = {
				overlord_of = MAM
				NOT = { exists = MAM }
			}
		}

		effect = {
			add_prestige_or_monarch_power = { amount = 30 }
			country_event_with_insight = {
				id = mr_egypt.3
				insight_tooltip = egypt_conquest_east_3_event_insight_tt
			}

			add_faction_influence = {
				faction = wr_mamluks
				influence = 15
			}
		}
	}

	egypt_conquest_east_5 = {
		icon = mission_egyptian_mamluk_soldier
		position = 5
		required_missions = { egypt_conquest_east_3 }

		provinces_to_highlight = {
			OR = {
				area = aleppo_area
				area = syria_area
				AND = {
					is_capital = yes
					owner = {
						is_levantine_crusader_state = yes
					}
				}
			}
			NOT = { country_or_non_sovereign_subject_holds = ROOT }
		}

		trigger = {
			aleppo_area = { type = all country_or_non_sovereign_subject_holds = ROOT }
			syria_area = { type = all country_or_non_sovereign_subject_holds = ROOT }
			any_known_country = {
				is_levantine_crusader_state = yes
				is_subject_of = ROOT
			}
		}

		effect = {
			add_years_of_income = 2
			add_permanent_claim_multi_provinces = { target = mashriq_region }

			add_faction_influence = {
				faction = wr_mamluks
				influence = 10
			}
		}
	}
}
